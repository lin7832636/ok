<?php
/**
 * 商城相关接口API非登录接口
 * ============================================================================
 * 版权所有 (C) 
 * 网站地址:
 * ============================================================================
 * $Version: v1.0.0 Beta $
 * $Author: baoxu <baoxu@pokpets.com> $
 * $Date: 2016/05/19 $
 * $Id: B2b2cController.class.php 2016/05/19  $
**/
namespace Api\Controller;
use Think\Controller;
class B2b2cPublicController extends PublicController {

    public function __construct() {
        parent::__construct();
    }
	
	/**
     * +--------------------------------------------------------------------------------------------------------------------
     * 收藏商品
     * +--------------------------------------------------------------------------------------------------------------------
     * @Author 何俊林   Date:2016/6/14
     * +--------------------------------------------------------------------------------------------------------------------
     * @access public
     * +--------------------------------------------------------------------------------------------------------------------
     * @type GET
     * +--------------------------------------------------------------------------------------------------------------------
     * @parame Int 必填 $goods_id 商品ID
     * +--------------------------------------------------------------------------------------------------------------------
     * @return JSON 
            {
                'name':'value', //返回值注释
                'name':'value'  //返回值注释
            }
     * +--------------------------------------------------------------------------------------------------------------------
    **/

    /**
     * +--------------------------------------------------------------------------------------------------------------------
     * 商品详情页
     * +--------------------------------------------------------------------------------------------------------------------
     * @Author hejunling   Date:2017/6/15
     * +--------------------------------------------------------------------------------------------------------------------
     * @access public
     * +--------------------------------------------------------------------------------------------------------------------
     * @type GET
     * +--------------------------------------------------------------------------------------------------------------------
     * @parame Int 必填 $goods_id 商品ID
     * +--------------------------------------------------------------------------------------------------------------------
     * @return JSON
    {
    'name':'value', //返回值注释
    'name':'value'  //返回值注释
    }
     * +--------------------------------------------------------------------------------------------------------------------
     **/
    public function GetGoodsInfo(){
        $data['goods_id'] = I('get.goods_id', 0, 'intval');
        $favorite=M('goods');
        $data=$favorite->join('sp_brand on sp_goods.brand_id=sp_brand.brand_id')->where(array('goods_id'=> $data['goods_id'] ))->find();
        output(0,$data);
    }
    /**
     * +--------------------------------------------------------------------------------------------------------------------
     * 商品规格详情页
     * +--------------------------------------------------------------------------------------------------------------------
     * @Author hejunling   Date:2017/6/15
     * +--------------------------------------------------------------------------------------------------------------------
     * @access public
     * +--------------------------------------------------------------------------------------------------------------------
     * @type GET
     * +--------------------------------------------------------------------------------------------------------------------
     * @parame Int 必填 $goods_id 商品ID
     * +--------------------------------------------------------------------------------------------------------------------
     * @return JSON
    {
    'name':'value', //返回值注释
    'name':'value'  //返回值注释
    }
     * +--------------------------------------------------------------------------------------------------------------------
     **/
    public function GetGoodsProduct(){
        $data['goods_id'] = I('get.goods_id', 0, 'intval');
        $favorite=M('product');
        $data=$favorite->where(array('goods_id'=> $data['goods_id'] ))->select();
        output(0,$data);
    }
    //获取面包屑导航的商品类型信息
    public function GetGoodsTypeNavi(){
        $good_type_id=I('get.goods_type_id');
        $favorite=M('goods_type');
        $data=$favorite->where(array('goods_type_id'=>$good_type_id))->select();
        output(0,$data);
    }

    /**
     * +--------------------------------------------------------------------------------------------------------------------
     * 轮播图
     * +--------------------------------------------------------------------------------------------------------------------
     * @Author 贾恩超   Date:2017/6/16
     * +--------------------------------------------------------------------------------------------------------------------
     * @access public
     * +--------------------------------------------------------------------------------------------------------------------
     **/
    public function Carousel(){
        $type=I('get.type');
        $map['carousel_status']  = array('gt',0);
        $lis = M('carousel')->where($map)->limit($type)->select();
        output(0,$lis);
    }


    /**
     * +--------------------------------------------------------------------------------------------------------------------
     * 全部商品分类
     * +--------------------------------------------------------------------------------------------------------------------
     * @Author 丁新江   Date:2016/6/16
     * +--------------------------------------------------------------------------------------------------------------------
     * @access public
     * +--------------------------------------------------------------------------------------------------------------------
     * @parame Int 必填 无
     * +--------------------------------------------------------------------------------------------------------------------
     * @return JSON 
     **/
    public function GetGoodsTypeList()
    {
        $type = M('goods_type');
        $a = $type->select();
        $list = get_category_tree($a);
        output(0,$list);
    }    

    /**
     * +--------------------------------------------------------------------------------------------------------------------
     * 商品二级分类
     * +--------------------------------------------------------------------------------------------------------------------
     * @Author 丁新江   Date:2016/6/16
     * +--------------------------------------------------------------------------------------------------------------------
     * @access public
     * +--------------------------------------------------------------------------------------------------------------------
     * @parame Int 必填 无
     * +--------------------------------------------------------------------------------------------------------------------
     * @return JSON 
     **/
    public function GetGoodsByRecommendMobile()
    {
        // 接到传来的ID
        $goods_type_id = I('get.goods_type_id');
        $type = M('goods_type');
        // 查询分类表内的内容
        $a = $type->where(array('type_pid'=>$goods_type_id))->select();
         output(0,$a);   
    }
}